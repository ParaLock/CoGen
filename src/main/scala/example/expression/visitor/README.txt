Visitor solution done and then reworked to use AbstractGenerator, but this original
working solution remains for archives.


